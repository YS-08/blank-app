import streamlit as st

# session_state ì´ˆê¸°í™”
# 'submitted' ìƒíƒœê°€ session_stateì— ì—†ìœ¼ë©´ Falseë¡œ ì´ˆê¸°í™”
if 'submitted' not in st.session_state:
    st.session_state.submitted = False

# MBTI ìœ í˜•ë³„ í•™ìŠµ ìŠ¤íƒ€ì¼ ì„¤ëª…
learning_styles = {
    "ISTJ": "í˜„ì‹¤ì ì´ê³  ì²´ê³„ì ì´ì–´ì„œ, ëª…í™•í•œ ëª©í‘œì™€ ê³„íšì— ë”°ë¼ í•™ìŠµí•  ë•Œ íš¨ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤. ì‹¤ì œ ì‚¬ë¡€ì™€ ë°ì´í„°ë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ISFJ": "ë”°ëœ»í•˜ê³  ì±…ì„ê°ì´ ê°•í•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì„ ë•ëŠ” ê³¼ì •ì—ì„œ í•™ìŠµ ë™ê¸°ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì¡°ìš©í•˜ê³  ì•ˆì •ì ì¸ í™˜ê²½ì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "INFJ": "í†µì°°ë ¥ì´ ë›°ì–´ë‚˜ê³  ì´ìƒì£¼ì˜ì ì´ë©°, í•™ìŠµ ë‚´ìš©ì´ ê°–ëŠ” ì˜ë¯¸ì™€ ê°€ì¹˜ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤. ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "INTJ": "ì „ëµì ì´ê³  ë…¼ë¦¬ì ì´ë©°, ë³µì¡í•œ ì´ë¡ ê³¼ ê°œë…ì„ ì´í•´í•˜ëŠ” ë° ë›°ì–´ë‚©ë‹ˆë‹¤. ë…ë¦½ì ìœ¼ë¡œ ê¹Šì´ íŒŒê³ ë“œëŠ” í•™ìŠµì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ISTP": "ë…¼ë¦¬ì ì´ê³  ì‹¤ìš©ì ì´ì–´ì„œ, ì§ì ‘ ì†ìœ¼ë¡œ ë§Œì§€ê³  ê²½í—˜í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ê°€ì¥ ì¢‹ì•„í•©ë‹ˆë‹¤. ë¬¸ì œ í•´ê²° ê³¼ì • ìì²´ë¥¼ ì¦ê¹ë‹ˆë‹¤.",
    "ISFP": "ì˜¨í™”í•˜ê³  í˜¸ê¸°ì‹¬ì´ ë§ìœ¼ë©°, ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ì¡°í™”ë¡œìš´ ë¶„ìœ„ê¸°ì—ì„œ ììœ ë¡­ê²Œ ìì‹ ì˜ ê´€ì‹¬ì‚¬ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "INFP": "ì´ìƒì£¼ì˜ì ì´ê³  ì°½ì˜ì ì´ë©°, ìì‹ ì˜ ê°€ì¹˜ê´€ê³¼ ì¼ì¹˜í•˜ëŠ” ë‚´ìš©ì„ ë°°ìš¸ ë•Œ ê°€ì¥ ëª°ì…í•©ë‹ˆë‹¤. ìƒìƒë ¥ì´ í’ë¶€í•©ë‹ˆë‹¤.",
    "INTP": "ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ê³  ë…¼ë¦¬ì ì´ì–´ì„œ, ë³µì¡í•œ ì•„ì´ë””ì–´ë‚˜ ì‹œìŠ¤í…œì˜ ì›ë¦¬ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ì¶”ìƒì ì¸ ê°œë…ì„ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "ESTP": "ì—ë„ˆì§€ê°€ ë„˜ì¹˜ê³  ì‹¤ìš©ì ì´ì–´ì„œ, ì§ì ‘ ë¶€ë”ªíˆê³  ê²½í—˜í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. í™œë™ì ì¸ í•™ìŠµ í™˜ê²½ì—ì„œ ë‘ê°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.",
    "ESFP": "ì‚¬êµì ì´ê³  í™œë™ì ì´ì–´ì„œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ì–´ìš¸ë¦¬ë©° ì¦ê²ê²Œ ë°°ìš°ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì‹¤ì œ ê²½í—˜ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤.",
    "ENFP": "ì—´ì •ì ì´ê³  ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ë‹¤ì–‘í•œ ê°€ëŠ¥ì„±ì„ íƒìƒ‰í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ê¸ì •ì ì¸ ë¶„ìœ„ê¸°ì—ì„œ ì°½ì˜ë ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤.",
    "ENTP": "ë…ì°½ì ì´ê³  ë…¼ë¦¬ì ì´ì–´ì„œ, ì§€ì ì¸ ë„ì „ì„ ì¦ê¸°ê³  ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. í† ë¡ ê³¼ ë…¼ìŸì„ í†µí•´ í•™ìŠµí•©ë‹ˆë‹¤.",
    "ESTJ": "ì²´ê³„ì ì´ê³  í˜„ì‹¤ì ì´ì–´ì„œ, ì •í•´ì§„ ì ˆì°¨ì™€ ê·œì¹™ì— ë”°ë¼ íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµí•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì‹¤ìš©ì ì¸ ì§€ì‹ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "ESFJ": "ì‚¬êµì ì´ê³  ì±…ì„ê°ì´ ê°•í•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í˜‘ë ¥í•˜ê³  ì¡°í™”ë¡œìš´ ê´€ê³„ ì†ì—ì„œ í•™ìŠµí•  ë•Œ ëŠ¥ë¥ ì´ ì˜¤ë¦…ë‹ˆë‹¤.",
    "ENFJ": "ì—´ì •ì ì´ê³  ì¹´ë¦¬ìŠ¤ë§ˆê°€ ìˆìœ¼ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ì„ ë•ëŠ” ë°ì„œ ë³´ëŒì„ ëŠë‚ë‹ˆë‹¤. ìƒí˜¸ì‘ìš©ì´ í™œë°œí•œ í•™ìŠµì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ENTJ": "ì „ëµì ì´ê³  ë¦¬ë”ì‹­ì´ ë›°ì–´ë‚˜ë©°, ì¥ê¸°ì ì¸ ëª©í‘œë¥¼ ì„¸ìš°ê³  ì²´ê³„ì ìœ¼ë¡œ ì§€ì‹ì„ ìŠµë“í•©ë‹ˆë‹¤. íš¨ìœ¨ì„±ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤."
}

# ì§ˆë¬¸ê³¼ ì„ íƒì§€ ì •ì˜
questions = {
    "EI": {
        "question": "1. ì²˜ìŒ ë§Œë‚˜ëŠ” ì‚¬ëŒë“¤ê³¼ì˜ íŒŒí‹°ì— ê°”ì„ ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ì£¼ë¡œ ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•˜ë©° ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤.": "E", "ì†Œìˆ˜ì˜ ìµìˆ™í•œ ì‚¬ëŒë“¤ê³¼ ê¹Šì€ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ë©° ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤.": "I"},
    },
    "SN": {
        "question": "2. ìƒˆë¡œìš´ ê¸°ìˆ ì„ ë°°ìš¸ ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ì‹¤ì œ ì˜ˆì œì™€ êµ¬ì²´ì ì¸ ì‚¬ìš©ë²•ì„ ë¨¼ì € í™•ì¸í•œë‹¤.": "S", "ê¸°ë³¸ ì›ë¦¬ì™€ ì „ì²´ì ì¸ ê°œë…ì„ ë¨¼ì € ì´í•´í•˜ë ¤ê³  í•œë‹¤.": "N"},
    },
    "TF": {
        "question": "3. ì¹œêµ¬ê°€ ì½”ë”© ë¬¸ì œë¥¼ ë„ì™€ë‹¬ë¼ê³  í•  ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ë¬¸ì œì˜ ì›ì¸ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ì„í•˜ê³  í•´ê²°ì±…ì„ ì œì‹œí•œë‹¤.": "T", "ì¹œêµ¬ê°€ ì–¼ë§ˆë‚˜ ë‹µë‹µí•˜ê³  í˜ë“ ì§€ ê³µê°í•˜ê³  ìœ„ë¡œí•´ ì¤€ë‹¤.": "F"},
    },
    "JP": {
        "question": "4. ì½”ë”© í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ì „ì²´ ê³„íšì„ ì„¸ìš°ê³  ì²´ê³„ì ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•œë‹¤.": "J", "ì¼ë‹¨ ì‹œì‘í•˜ê³  ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ê³„íšì„ ë³€ê²½í•œë‹¤.": "P"},
    },
    "EI2": {
        "question": "5. ì£¼ë§ì— íœ´ì‹ì„ ì·¨í•  ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ì¹œêµ¬ë“¤ê³¼ ë§Œë‚˜ê±°ë‚˜ ì•¼ì™¸ í™œë™ì„ í•˜ë©° ì¬ì¶©ì „í•œë‹¤.": "E", "ì§‘ì—ì„œ ì¡°ìš©íˆ ì±…ì„ ì½ê±°ë‚˜ ì·¨ë¯¸ ìƒí™œì„ í•˜ë©° ì¬ì¶©ì „í•œë‹¤.": "I"},
    },
    "SN2": {
        "question": "6. ì„¤ëª…ì„œë¥¼ ì½ì„ ë•Œ, ë‹¹ì‹ ì€...",
        "options": {"ë‹¨ê³„ë³„ ì§€ì¹¨ì„ ê¼¼ê¼¼íˆ ë”°ë¼ í•˜ëŠ” í¸ì´ë‹¤.": "S", "ì „ì²´ì ì¸ ê·¸ë¦¼ì„ íŒŒì•…í•œ í›„ ì„¸ë¶€ ì‚¬í•­ì€ ê±´ë„ˆë›°ëŠ” í¸ì´ë‹¤.": "N"},
    }
}

def calculate_mbti(answers):
    """
    ì‚¬ìš©ìì˜ ë‹µë³€ì„ ë°”íƒ•ìœ¼ë¡œ MBTI ìœ í˜•ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
    """
    scores = {'E': 0, 'I': 0, 'S': 0, 'N': 0, 'T': 0, 'F': 0, 'J': 0, 'P': 0}
    for key, value in answers.items():
        if value:  # ë‹µë³€ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì ìˆ˜ ê³„ì‚°
            scores[value] += 1

    mbti = ""
    mbti += "E" if scores['E'] >= scores['I'] else "I"
    mbti += "S" if scores['S'] >= scores['N'] else "N"
    mbti += "T" if scores['T'] >= scores['F'] else "F"
    mbti += "J" if scores['J'] >= scores['P'] else "P"
    
    return mbti

def submitted_callback():
    """
    ì œì¶œ ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” ì½œë°± í•¨ìˆ˜
    """
    st.session_state.submitted = True

# --- ì•± UI êµ¬ì„± ---
st.title("MBTI í•™ìŠµ ìœ í˜• ì§„ë‹¨ ğŸ”")
st.write("ê°„ë‹¨í•œ ì§ˆë¬¸ì„ í†µí•´ ìì‹ ì˜ í•™ìŠµ ìŠ¤íƒ€ì¼ê³¼ ë§ëŠ” MBTI ìœ í˜•ì„ ì•Œì•„ë³´ì„¸ìš”!")

# ì‚¬ìš©ìì˜ ë‹µë³€ì„ ì €ì¥í•  ë”•ì…”ë„ˆë¦¬
user_answers = {}

# st.formì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì§ˆë¬¸ì„ í•œ ë²ˆì— ì œì¶œë°›ìŒ
with st.form("mbti_form"):
    # ê° ì§ˆë¬¸ì— ëŒ€í•´ ë¼ë””ì˜¤ ë²„íŠ¼ ìƒì„±
    for key, q in questions.items():
        # st.radioì˜ keyëŠ” ê³ ìœ í•´ì•¼ í•˜ë¯€ë¡œ ì§ˆë¬¸ì˜ key(ì˜ˆ: "EI")ë¥¼ ì‚¬ìš©
        answer_text = st.radio(q["question"], options=q["options"].keys(), key=key)
        user_answers[key] = q["options"][answer_text]

    # ì œì¶œ ë²„íŠ¼
    submit_button = st.form_submit_button("ê²°ê³¼ í™•ì¸í•˜ê¸°", on_click=submitted_callback)

# ì œì¶œ ë²„íŠ¼ì´ í´ë¦­ë˜ì—ˆê³ , session_state.submittedê°€ Trueì´ë©´ ê²°ê³¼ í‘œì‹œ
if st.session_state.submitted:
    mbti_result = calculate_mbti(user_answers)
    
    st.header(f"ğŸ“ˆ ë‹¹ì‹ ì˜ MBTI í•™ìŠµ ìœ í˜•ì€: {mbti_result}")
    
    # ê²°ê³¼ì— í•´ë‹¹í•˜ëŠ” í•™ìŠµ ìŠ¤íƒ€ì¼ ì„¤ëª…ì„ ì°¾ì•„ ì¶œë ¥
    if mbti_result in learning_styles:
        st.info(learning_styles[mbti_result])
    else:
        st.warning("ê²°ê³¼ì— í•´ë‹¹í•˜ëŠ” í•™ìŠµ ìŠ¤íƒ€ì¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")

    st.write("---")
    st.write("*ì£¼ì˜: ì´ ì§„ë‹¨ì€ ì¬ë¯¸ë¥¼ ìœ„í•œ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ì´ë©°, ì •ì‹ MBTI ê²€ì‚¬ì™€ëŠ” ë‹¤ë¦…ë‹ˆë‹¤.*")